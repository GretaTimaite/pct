<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting and using data from the PCT • pct</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting and using data from the PCT">
<meta property="og:description" content="pct">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pct</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/pct.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cycling-potential-uk.html">Cycling potential in UK cities</a>
    </li>
    <li>
      <a href="../articles/getting.html">Getting and using data from the PCT</a>
    </li>
    <li>
      <a href="../articles/km-cycled.html">Estimating distance cycled per zone in England and Wales regions</a>
    </li>
    <li>
      <a href="../articles/pct-international.html">International application of the PCT methods</a>
    </li>
    <li>
      <a href="../articles/pct_training.html">Propensity to Cycle Tool Advanced Workshop</a>
    </li>
    <li>
      <a href="../articles/uk-cities.html">Reproducing cycling potential estimates in UK cities</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ITSLeeds/pct/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="getting_files/jquery-1.11.3/jquery.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1">
<link href="getting_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet">
<script src="getting_files/bootstrap-3.3.5/js/bootstrap.min.js"></script><script src="getting_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script><script src="getting_files/bootstrap-3.3.5/shim/respond.min.js"></script><style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="getting_files/navigation-1.1/tabsets.js"></script><script src="getting_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting and using data from the PCT</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ITSLeeds/pct/blob/master/vignettes/getting.Rmd"><code>vignettes/getting.Rmd</code></a></small>
      <div class="hidden name"><code>getting.Rmd</code></div>

    </div>

    
    
<p>If you are following this guide as part of the <a href="https://hopin.com/events/cycle-active-city-2021">Cycle City Active City 2021</a> conference, the workshops are scheduled at the following times:</p>
<ul>
<li><p>Propensity to Cycle Tool: getting and using the data, based on section <a href="#getting-pct-data"><strong>??</strong></a> 11:30 - 12:30</p></li>
<li><p>Propensity to Cycle Tool: build your own scenarios, based on section <a href="#modelling-change">2</a> 13:30 - 14:30</p></li>
</ul>
<div id="getting-and-exploring-pct-data" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-and-exploring-pct-data" class="anchor"></a><span class="header-section-number">1</span> Getting and exploring PCT data</h1>
<!-- From ccac 2021 -->
<p>In this section you will learn about the open datasets provided by the PCT project and how to use them.
While the most common use of the PCT is via the interactive web application hosted at www.pct.bike, there is much value in downloading the data, e.g. to identify existing cycling infrastructure in close proximity to routes with high potential, and to help identify roads in need of interventions from a safety perspective, using data from the constantly evolving and community-driven global geographic database OpenStreetMap (OSM) <span class="citation">(Barrington-Leigh and Millard-Ball 2017)</span>.</p>
<p>In this session, which assumes you know how to have experience using QGIS, or R, you will learn how to:</p>
<ul>
<li>Find data on travel behaviour from the 2011 Census and from the School Census</li>
<li>How to download and import data from the PCT into QGIS</li>
<li>How to process the data alongside infrastructure data, to help find gaps in the network</li>
</ul>
<div id="getting-pct-data-from-the-pct-website" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-pct-data-from-the-pct-website" class="anchor"></a><span class="header-section-number">1.1</span> Getting PCT data from the PCT website</h2>
<p>In this example we will use data from North Yorkshire, an area with urban areas surrounding York and many rural areas.
You can use the PCT, which works at the regional level, for North Yorkshire or any other region by clicking on the area you’re interested in on the main map at <a href="https://www.pct.bike" class="uri">https://www.pct.bike</a>.
If you know the URL of the region you’re interested in, you can navigate straight there, in this case by typing in on clicking on the link <a href="https://www.pct.bike/m/?r=north-yorkshire" class="uri">https://www.pct.bike/m/?r=north-yorkshire</a>.</p>
<p>From there you will see a map showing the region.
Before you download and use PCT data, it is worth exploring it on the PCT web app.</p>
<div id="exercise-explore-the-current-level-and-distribution-of-cycling" class="section level3">
<h3 class="hasAnchor">
<a href="#exercise-explore-the-current-level-and-distribution-of-cycling" class="anchor"></a><span class="header-section-number">1.1.1</span> Exercise: explore the current level and distribution of cycling</h3>
<ul>
<li>Explore different data layers contained in the PCT by selecting different options from the dropdown menus on the right.</li>
<li>Look at the different types of Cycling Flows options and consider: which visualisation layer is most useful?</li>
</ul>
<!-- It depends --><ul>
<li>Bonus: find the areas that would benefit from improved cycling provision on Clifton bridge, 1 km northwest from central York over the River Ouse (see result in Figure <a href="#fig:clifton">1.1</a>)<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>
</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span><span class="op">(</span><span class="st">"https://user-images.githubusercontent.com/1825120/130370123-5b8885de-4aed-43b4-8a49-b2f875ffff1b.png"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:clifton"></span>
<img src="https://user-images.githubusercontent.com/1825120/130370123-5b8885de-4aed-43b4-8a49-b2f875ffff1b.png" alt="Areas that may benefit from improved cycle provision on Clifton Bridge, according to the PCT."><p class="caption">
Figure 1.1: Areas that may benefit from improved cycle provision on Clifton Bridge, according to the PCT.
</p>
</div>
</div>
</div>
<div id="visualising-pct-data-in-qgis" class="section level2">
<h2 class="hasAnchor">
<a href="#visualising-pct-data-in-qgis" class="anchor"></a><span class="header-section-number">1.2</span> Visualising PCT data in QGIS</h2>
</div>
<div id="comparing-pct-data-with-transport-network-data" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-pct-data-with-transport-network-data" class="anchor"></a><span class="header-section-number">1.3</span> Comparing PCT data with transport network data</h2>
</div>
<div id="identifying-gaps-in-the-network" class="section level2">
<h2 class="hasAnchor">
<a href="#identifying-gaps-in-the-network" class="anchor"></a><span class="header-section-number">1.4</span> Identifying gaps in the network</h2>
</div>
<div id="getting-pct-data-with-r" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-pct-data-with-r" class="anchor"></a><span class="header-section-number">1.5</span> Getting PCT data with R</h2>
<p>We will get PCT data at the MSOA level and plot the result in a simple map.</p>
<ul>
<li>G1: The first stage is to load packages we will use:</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://itsleeds.github.io/pct/">pct</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span>      <span class="co"># key package for working with spatial vector data</span></code></pre></div>
<pre><code>## Linking to GEOS 3.8.1, GDAL 3.2.1, PROJ 7.2.1</code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>   <span class="co"># in the tidyverse</span></code></pre></div>
<pre><code>## 
## Attaching package: 'dplyr'</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mtennekes/tmap">tmap</a></span><span class="op">)</span>    <span class="co"># installed alongside mapview</span></code></pre></div>
<ul>
<li>G2: After setting the region name (to avoid re-typing it many times) run the following commands to download data at the four main levels used in the PCT:</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">region_name</span> <span class="op">=</span> <span class="st">"north-yorkshire"</span>
<span class="va">zones_all</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_pct_zones.html">get_pct_zones</a></span><span class="op">(</span><span class="va">region_name</span>, geography <span class="op">=</span> <span class="st">"msoa"</span><span class="op">)</span>
<span class="va">lines_all</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_pct_lines.html">get_pct_lines</a></span><span class="op">(</span><span class="va">region_name</span>, geography <span class="op">=</span> <span class="st">"msoa"</span><span class="op">)</span>
<span class="va">routes_all</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_pct_routes_fast.html">get_pct_routes_fast</a></span><span class="op">(</span><span class="va">region_name</span>, geography <span class="op">=</span> <span class="st">"msoa"</span><span class="op">)</span>
<span class="va">rnet_all</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_pct_rnet.html">get_pct_rnet</a></span><span class="op">(</span><span class="va">region_name</span><span class="op">)</span></code></pre></div>
<ul>
<li>G3: Check the downloads worked by plotting the result as follows:</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">zones_all</span><span class="op">$</span><span class="va">geometry</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">lines_all</span><span class="op">$</span><span class="va">geometry</span>, col <span class="op">=</span> <span class="st">"blue"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">routes_all</span><span class="op">$</span><span class="va">geometry</span>, col <span class="op">=</span> <span class="st">"green"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html">plot</a></span><span class="op">(</span><span class="va">rnet_all</span><span class="op">$</span><span class="va">geometry</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">rnet_all</span><span class="op">$</span><span class="va">bicycle</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="getting_files/figure-html/plotall-1.png" width="70%"></p>
</div>
</div>
<div id="modelling-change" class="section level1">
<h1 class="hasAnchor">
<a href="#modelling-change" class="anchor"></a><span class="header-section-number">2</span> Modelling change</h1>
<!-- From ccag 2021 -->
<p>This section is designed for people with experience with the PCT and cycling uptake estimates who want to learn more about how uptake models work and how to generate new scenarios of change.
Reproducible and open R code will be used to demonstrate the concepts so knowledge of R or other programming languages is recommended but not essential, as there will be conceptual exercises covering the factors linked to mode shift.
In it you will:</p>
<ul>
<li>Learn about the uptake model underlying the Propensity to Cycle Tool scenarios</li>
<li>Develop your own uptake model in conceptual terms, e.g., to represent the government’s target for 50% of all trips in cities to be made by walking and cycling by 2030</li>
<li>Learn how to train uptake models against data, to build evidence-based uptake models</li>
</ul>
<div id="pct-scenarios" class="section level2">
<h2 class="hasAnchor">
<a href="#pct-scenarios" class="anchor"></a><span class="header-section-number">2.1</span> PCT scenarios</h2>
<ul>
<li>S1: Generate a ‘Go Dutch’ scenario for the North Yorkshire using the function <code><a href="../reference/uptake_pct_godutch.html">uptake_pct_godutch()</a></code> (hint: the following code chunk will create a ‘Government Target’ scenario):</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lines_all</span><span class="op">$</span><span class="va">pcycle</span> <span class="op">=</span> <span class="va">lines_all</span><span class="op">$</span><span class="va">bicycle</span> <span class="op">/</span> <span class="va">lines_all</span><span class="op">$</span><span class="va">all</span>
<span class="va">lines_all</span><span class="op">$</span><span class="va">euclidean_distance</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html">st_length</a></span><span class="op">(</span><span class="va">lines_all</span><span class="op">)</span><span class="op">)</span>
<span class="va">lines_all</span><span class="op">$</span><span class="va">pcycle_govtarget</span> <span class="op">=</span> <span class="fu"><a href="../reference/uptake_pct_govtarget.html">uptake_pct_govtarget_2020</a></span><span class="op">(</span>
  distance <span class="op">=</span> <span class="va">lines_all</span><span class="op">$</span><span class="va">rf_dist_km</span>,
  gradient <span class="op">=</span> <span class="va">lines_all</span><span class="op">$</span><span class="va">rf_avslope_perc</span>
  <span class="op">)</span> <span class="op">*</span> <span class="fl">100</span> <span class="op">+</span> <span class="va">lines_all</span><span class="op">$</span><span class="va">pcycle</span></code></pre></div>
<div class="figure">
<img src="getting_files/figure-html/dutch_pcycle-1.png" alt="Percent cycling currently (left) and under a 'Go Dutch' scenario (right) in the Isle of Wight." width="672"><img src="getting_files/figure-html/dutch_pcycle-2.png" alt="Percent cycling currently (left) and under a 'Go Dutch' scenario (right) in the Isle of Wight." width="672"><p class="caption">
(#fig:dutch_pcycle)Percent cycling currently (left) and under a ‘Go Dutch’ scenario (right) in the Isle of Wight.
</p>
</div>
<ul>
<li>S2: Think of alternative scenarios that would be useful for your work</li>
<li>S3 (bonus): look inside the function <a href="https://github.com/ITSLeeds/pct/blob/master/R/uptake.R#L36"><code>pct_uptake_godutch()</code></a> - how could it be modified?</li>
</ul>
</div>
<div id="developing-new-scenarios-of-change" class="section level2">
<h2 class="hasAnchor">
<a href="#developing-new-scenarios-of-change" class="anchor"></a><span class="header-section-number">2.2</span> Developing new scenarios of change</h2>
</div>
<div id="training-uptake-models-against-new-datasets" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#training-uptake-models-against-new-datasets" class="anchor"></a>Training uptake models against new datasets</h2>
<div id="refs" class="references">
<div id="ref-barrington-leigh_world_2017">
<p>Barrington-Leigh, Christopher, and Adam Millard-Ball. 2017. “The World’s User-Generated Road Map Is More Than 80% Complete.” <em>PLOS ONE</em> 12 (8): e0180698. <a href="https://doi.org/10.1371/journal.pone.0180698">https://doi.org/10.1371/journal.pone.0180698</a>.</p>
</div>
</div>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>
Hint: Select the Fast Routes option from the Cycling Flows menu, zoom into the Bridge, and then click on the Freeze Lines checkbox to prevent the selected routes from moving when you zoom back out.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Robin Lovelace, Layik Hama.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
